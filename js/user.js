webpackJsonp([10],{J6BJ:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});e("n12u");var r={name:"UserItem",props:{user:{type:Object,required:!0}},data:function(){return{}},computed:{isFollow:function(){var t=this.user,s=t.follower,e=void 0!==s&&s,r=t.following,a=void 0!==r&&r;return e&&a?"eachFollow":e?"follow":"unFollow"}},methods:{followUser:function(){var t=this;if(this.loading)return!1;this.loading=!0,this.$store.dispatch("FOLLOW_USER",{id:this.user.id,status:this.isFollow}).then(function(s){var e=s.follower;t.loading=!1,t.user.follower=e}).catch(function(s){var e=s.response;e=void 0===e?{}:e;var r=e.data,a=void 0===r?{message:"操作失败"}:r;t.loading=!1,t.$Message.error(a)})}}},a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user-item",attrs:{id:"user-item-"+t.user.id}},[e("v-avatar",{staticClass:"user-item-avatar",attrs:{uid:t.user.id,sex:t.user.sex,src:t.user.avatar}}),e("div",{staticClass:"user-item-info"},[e("p",{staticClass:"user-item-name ellipsis"},[t._v(t._s(t.user.name))]),e("p",{staticClass:"user-item-bio ellipsis"},[t._v(t._s(t.user.bio||"这家伙很懒,什么也没留下"))])]),e("svg",{staticClass:"user-item-follow-icon",on:{click:function(s){return s.stopPropagation(),t.followUser(s)}}},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#base-"+t.isFollow}})])],1)},i=[],o=e("XyMi");function n(t){e("qnaE")}var l=!1,u=n,c=null,f=null,h=Object(o["a"])(r,a,i,l,u,c,f),m=h.exports,d={name:"UserFans",components:{UserItem:m},data:function(){return{userList:[],refreshData:[]}},computed:{userID:function(){return this.$route.params.userID},type:function(){var t=this.$route.query.type;return t||"followers"}},watch:{type:function(){this.userList=[],this.$refs.loadmore.beforeRefresh()},refreshData:function(t){t.length>0&&(this.userList=Object.assign([],this.userList,t))}},methods:{navTo:function(t){return{path:"/user/".concat(this.userID,"/fans"),query:{type:t}}},onRefresh:function(){var t=this;this.refreshData=[],this.$http.get("/users/".concat(this.userID,"/").concat(this.type)).then(function(s){var e=s.data,r=void 0===e?[]:e;r.length>0&&(t.refreshData=r),t.$refs.loadmore.topEnd(!(r.length<20))})},onLoadMore:function(){var t=this;this.$http.get("/users/".concat(this.userID,"/").concat(this.type),{params:{limit:15,offset:this.userList.length}}).then(function(s){var e=s.data,r=void 0===e?[]:e;r.length>0&&(t.userList=t.userList.concat(r)),t.$refs.loadmore.bottomEnd(r.length<15)})}}},v=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"user-fans"},[e("nav",{staticClass:"m-box m-head-top m-justify-bet m-lim-width m-pos-f m-main m-bb1"},[e("div",{staticClass:"m-box m-aln-center"},[e("svg",{staticClass:"m-style-svg m-svg-def",on:{click:t.goBack}},[e("use",{attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink","xlink:href":"#base-back"}})])]),e("ul",{staticClass:"m-box m-flex-grow1 m-flex-shrink0 m-aln-center m-justify-center m-flex-base0 m-head-nav"},[e("router-link",{attrs:{tag:"li",to:t.navTo("followers"),"active-class":"active",exact:""}},[e("a",[t._v("粉丝")])]),e("router-link",{attrs:{tag:"li",to:t.navTo("followings"),"active-class":"active",exact:""}},[e("a",[t._v("关注")])])],1),e("div",{staticClass:"m-box m-justify-end"})]),e("main",{staticStyle:{"padding-top":"0.9rem"}},[e("load-more",{ref:"loadmore",staticClass:"user-fans--list",attrs:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},t._l(t.userList,function(s){return s.id?e("user-item",{key:"user-item-"+s.id,attrs:{user:s}}):t._e()}))],1)])},p=[];function g(t){e("osm+")}var w=!1,b=g,x=null,y=null,k=Object(o["a"])(d,v,p,w,b,x,y);s["default"]=k.exports},"osm+":function(t,s){},qnaE:function(t,s){}});
//# sourceMappingURL=user.js.map